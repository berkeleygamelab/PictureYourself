function kineticSetup(d,c){var a=new Kinetic.Stage({container:"container",width:d,height:c});var b=new Kinetic.Layer();a.add(b);return{stage:a,layer:b}}function backgroundSetup(e,d,c,a){var f=new Image();var b=new Kinetic.Image({image:f,x:0,y:0,width:a.getWidth(),height:a.getHeight()});f.src=default_background;f.onload=function(){c.add(b);b.setZIndex(0);c.draw()};b.on("click",function(){e()});return b}function grabBackgroundImages(a,c,b){c.get("/stickers/backgrounds").success(function(d){angular.forEach(d,function(f,e){html="<img src='/"+f+"' class='background' ng-click=\"background_update($event)\" alt='"+e+"'>";compiledElement=b(html)(a);$("#backgrounds_tab").append(compiledElement)})})}function grabStickerImages(b,d,c){var a="shoes_and_pants";d.get("/stickers").success(function(e){e=angular.fromJson(e);b.visible={};b.stickers=e.stickers;b.categories=e.categories;angular.forEach(b.stickers,function(g,f){b.visible[f]=(f==a);html="<div id="+f+"_subtab class='subtab_title' ng-click=\"toggle('"+f+"')\">"+b.categories[f]+"</div><div ng-show='visible."+f+"' id='"+f+"_content' class='subtab_content'></div>";compiledElement=c(html)(b);$("#sticker_tab").append(compiledElement);angular.forEach(g,function(h){$("#"+f+"_content").append("<img class='sticker "+f+"' src=\"/"+h.source+'" name="'+h.name+'" data-chroma_green="'+h.chroma_green.toString()+'"/>');if(h.chroma_green){b.image_sources[h.name]={fore:h.fore_source,back:h.back_source}}})});$(".sticker").bind("dragstart",function(f){b.dragSrcEl=this;debug($(this).data("chroma_green"));if($(this).data("chroma_green")==true){b.chroma_green=true}else{b.chroma_green=false}})})};